using Robust.Client.UserInterface.CustomControls;
using Content.Shared.Devour.Components;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.GameObjects;

namespace Content.Client.Devour.UI;

[GenerateTypedNameReferences]
public sealed partial class DevourSettingsWindow : BoxContainer
{
    private DevourSettingsComponent? _settings;



    public DevourSettingsWindow()
    {
        RobustXamlLoader.Load(this);

        SaveButton.OnPressed += OnSavePressed;
        CancelButton.OnPressed += OnCancelPressed;
    }

    public void SetSettings(DevourSettingsComponent settings)
    {
        _settings = settings;
        UpdateUI();
    }

    private void UpdateUI()
    {
        if (_settings == null)
            return;

        ScatEnabledCheckBox.Pressed = _settings.ScatEnabled;
        ShowDigestionMessagesCheckBox.Pressed = _settings.ShowDigestionMessages;
        ShowDevourMessagesCheckBox.Pressed = _settings.ShowDevourMessages;
        ShowScatMessagesCheckBox.Pressed = _settings.ShowScatMessages;
        ShowDetailedDigestionCheckBox.Pressed = _settings.ShowDetailedDigestion;
    }

    private void OnSavePressed(BaseButton.ButtonEventArgs args)
    {
        if (_settings == null)
            return;

        // Update settings from UI
        _settings.ScatEnabled = ScatEnabledCheckBox.Pressed;
        _settings.ShowDigestionMessages = ShowDigestionMessagesCheckBox.Pressed;
        _settings.ShowDevourMessages = ShowDevourMessagesCheckBox.Pressed;
        _settings.ShowScatMessages = ShowScatMessagesCheckBox.Pressed;
        _settings.ShowDetailedDigestion = ShowDetailedDigestionCheckBox.Pressed;

        Parent?.RemoveChild(this);
    }

    private void OnCancelPressed(BaseButton.ButtonEventArgs args)
    {
        Parent?.RemoveChild(this);
    }
}
